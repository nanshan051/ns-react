(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{497:function(s,t,a){"use strict";a.r(t);var n=a(2),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"_1-背景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-背景"}},[s._v("#")]),s._v(" 1. 背景")]),s._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"title"}),t("p",[s._v("将门户自定义部件成果物上传到 “运行管理中心” 平台后，在系统管理中创建 8T 主题并发布。"),t("br"),s._v("\n进入主题，"),t("strong",[s._v("页面白屏时间接近 "),t("code",[s._v("6 秒")]),s._v(" ，在此期间用户需要等待页面加载，这极大地影响用户使用体验")]),s._v("。")])]),t("img",{staticClass:"zoomable",attrs:{src:s.$withBase("/images/screenshot/notes/3/1/1.png"),alt:"foo"}}),s._v(" "),t("h2",{attrs:{id:"_2-问题定位"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-问题定位"}},[s._v("#")]),s._v(" 2. 问题定位")]),s._v(" "),t("h3",{attrs:{id:"_2-1-概念"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-概念"}},[s._v("#")]),s._v(" 2.1 概念")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("p",[t("strong",[s._v("『白屏时间』")]),s._v(" 是指从用户输入 URL 地址或点击链接，到浏览器开始显示内容的时间。白屏时间的长短将直接影响用户对产品的第一印象。")])]),t("h3",{attrs:{id:"_2-2-性能分析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-性能分析"}},[s._v("#")]),s._v(" 2.2 性能分析")]),s._v(" "),t("img",{staticClass:"zoomable",attrs:{src:s.$withBase("/images/screenshot/notes/3/1/2.png"),alt:"foo"}}),s._v(" "),t("ul",[t("li",[t("p",[s._v("从上图中的 overview 总览图可以看出，首页的白屏时间为 "),t("code",[s._v("5.6 秒")]),s._v("，其中，"),t("code",[s._v("/gait-widget/index.js")]),s._v(" "),t("strong",[s._v("这个 js 资源就占用了近 "),t("code",[s._v("4 秒")])]),s._v("。")])]),s._v(" "),t("li",[t("p",[s._v("从底部摘要可以看出，请求该 js 资源耗时 "),t("code",[s._v("2.55 秒")]),s._v("，加载该资源耗时 "),t("code",[s._v("1.40 秒")]),s._v("，解码前的体积为 "),t("code",[s._v("32.8 M")]),s._v("，解码后的体积为 "),t("code",[s._v("43.8 M")]),s._v("。")])])]),s._v(" "),t("p",[s._v("👉 该 js 资源为打包后的部件成果物，"),t("strong",{staticStyle:{color:"green"}},[s._v("初步推测应该是由于体积过大，导致请求和加载耗时较长")]),s._v(" 。")]),s._v(" "),t("h3",{attrs:{id:"_2-3-项目结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-项目结构"}},[s._v("#")]),s._v(" 2.3 项目结构")]),s._v(" "),t("p",[s._v("项目是采用部件脚手架 "),t("code",[s._v("@wdg/widget-cli")]),s._v(" 进行搭建的，下面是项目的 src 文件夹下的目录：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# src 目录")]),s._v("\n├─scaffold\n│  ├─assets\n│  │  └─img\n│  ├─components\n│  │  └─configTemplates\n│  ├─sourcePkgTemplate\n│  │  ├─META-INF\n│  │  └─resource\n│  │     └─widgets\n│  └─utils\n├─widget-components\n│  └─gait-widget-children\n│     └─ "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 多个子组件")]),s._v("\n├─widget-tools\n│  ├─api\n│  │  └─section\n│  │     └─gaitWidget.js "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 请求接口")]),s._v("\n│  ├─css\n│  │  └─font\n│  ├─img\n│  ├─mixin\n│  └─utils\n└─widgets\n   └─gait-widget\n      ├─index.vue\n      ├─package.json\n      └─public\n         ├─img\n            └─ "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 多张图片")]),s._v("\n         └─css\n            └─font\n               └─ "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 两种字体")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br")])]),t("h3",{attrs:{id:"_2-4-图片字体"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-图片字体"}},[s._v("#")]),s._v(" 2.4 图片字体")]),s._v(" "),t("p",[s._v("项目中用到的 "),t("strong",[s._v("图片")]),s._v(" 如下：")]),s._v(" "),t("img",{staticClass:"zoomable",attrs:{src:s.$withBase("/images/screenshot/notes/3/1/3.png"),alt:"foo"}}),s._v(" "),t("p",[s._v("项目中用到的 "),t("strong",[s._v("字体")]),s._v(" 如下：")]),s._v(" "),t("img",{staticClass:"zoomable",attrs:{src:s.$withBase("/images/screenshot/notes/3/1/4.png"),alt:"foo"}}),s._v(" "),t("p",[s._v("由于在开发过程中，没有单独编写 "),t("code",[s._v("css|scss|less")]),s._v(" 等样式文件，主要是引入了一些图片和两种字体，所以，下面主要分析项目中对图片和字体的打包处理。")]),s._v(" "),t("h3",{attrs:{id:"_2-5-loader-原理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-loader-原理"}},[s._v("#")]),s._v(" 2.5 loader 原理")]),s._v(" "),t("p",[s._v("我们知道，对图片和字体，webpack 无法直接处理，需要相应的 loader 进行预处理后，webpack 才能进行下一步处理。图片和字体都可以采用 "),t("code",[s._v("file-loader")]),s._v(" 或 "),t("code",[s._v("url-loader")]),s._v(" 来进行预处理。")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"},[s._v("file-loader 与 url-loader 在打包时的区别：")]),t("ol",[t("li",[t("p",[t("code",[s._v("file-loader")]),s._v("： 最终会输出对应的图片。")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("url-loader")]),s._v("： 内置了 "),t("code",[s._v("file-loader")]),s._v(" ，分为两种情况：")])])]),s._v(" "),t("p",[s._v("（1）图片体积 "),t("strong",[s._v("<")]),s._v(" 阈值时，"),t("strong",[s._v("将图片转为 "),t("code",[s._v("base64")]),s._v(" ，直接写入到 html 中。")])]),s._v(" "),t("p",[s._v("（2）图片体积 "),t("strong",[s._v(">")]),s._v(" 阈值时，"),t("strong",[s._v("将图片交由 "),t("code",[s._v("file-loader")]),s._v(" 处理，输出对应的图片。")])]),s._v(" "),t("p",[t("strong",[s._v("注意：")]),s._v(" "),t("strong",{staticStyle:{color:"red"}},[t("code",[s._v("url-loader")]),s._v(" 没有设置阈值时，默认将图片转为 "),t("code",[s._v("base64")]),s._v(" 。")])])]),t("h3",{attrs:{id:"_2-6-base64-特点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-base64-特点"}},[s._v("#")]),s._v(" 2.6 base64 特点")]),s._v(" "),t("p",[s._v("这里补充一下，"),t("code",[s._v("base64")]),s._v(" 的优缺点：")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("p",[t("strong",{staticStyle:{color:"green"}},[s._v("优点")]),s._v(" ："),t("code",[s._v("base64")]),s._v(" 不会生成单独的图片文件，最终会直接嵌入到 "),t("code",[s._v("html")]),s._v(" 中，获取时走的是『内存缓存』，因此 "),t("strong",{staticStyle:{color:"green"}},[s._v("可以减少请求，减轻服务器压力")]),s._v(" 。")]),s._v(" "),t("p",[t("strong",{staticStyle:{color:"red"}},[s._v("缺点")]),s._v(" ："),t("code",[s._v("base64")]),s._v(" 相较源文件 "),t("strong",{staticStyle:{color:"red"}},[s._v("体积更大")]),s._v(" ，且源文件越大，体积增加的越多，这会导致 "),t("strong",{staticStyle:{color:"red"}},[s._v("请求时间更长")]),s._v(" 。")])]),t("h3",{attrs:{id:"_2-7-当前-webpack-配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-7-当前-webpack-配置"}},[s._v("#")]),s._v(" 2.7 当前 webpack 配置")]),s._v(" "),t("p",[s._v("回过头来再看一下项目中的 webpack 配置：")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* webpack.common.js */")]),s._v("\nmodule"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("module")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("rules")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 图片")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("test")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token regex"}},[t("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("\\.(png|jpg|jpeg|gif|svg|webp)$")]),t("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("loader")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"url-loader"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 字体")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("test")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token regex"}},[t("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("\\.(woff2?|eot|ttf|otf)(\\?.*)?$")]),t("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("loader")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"url-loader"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("p",[s._v("从配置文件中可以看出，项目对图片和字体都采用 "),t("code",[s._v("url-loader")]),s._v(" 来进行预处理，且都没有设置阈值( "),t("code",[s._v("limit")]),s._v(" )，因此 "),t("strong",[s._v("图片和字体全都被转为 "),t("code",[s._v("base64")]),s._v(" 写入到成果物（ "),t("code",[s._v("index.js")]),s._v(" ）中，没有生成对应的图片和字体文件。")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生成的资源包目录")]),s._v("\n─META-INF\n└─resource\n    └─widgets\n        └─gait-widget\n           ├─index.js"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# base64在内)")]),s._v("\n           └─package.json\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("图片全都转为 "),t("code",[s._v("base64")]),s._v("，包括体积非常大的几个 webp 图片，走的是内存缓存：")]),s._v(" "),t("img",{staticClass:"zoomable",attrs:{src:s.$withBase("/images/screenshot/notes/3/1/5.png"),alt:"foo"}}),s._v(" "),t("p",[s._v("字体也全都转为 "),t("code",[s._v("base64")]),s._v("，走的是内存缓存：")]),s._v(" "),t("img",{staticClass:"zoomable",attrs:{src:s.$withBase("/images/screenshot/notes/3/1/6.png"),alt:"foo"}}),s._v(" "),t("p",[s._v("可以看出：")]),s._v(" "),t("div",{staticClass:"custom-block danger"},[t("p",{staticClass:"title"}),t("ol",[t("li",[t("p",[t("strong",{staticStyle:{color:"red"}},[s._v("请求时间长")]),s._v(" ：有一些体积非常大的图片和字体不适合转为 "),t("code",[s._v("base64")]),s._v(" ，因为会使得 "),t("code",[s._v("index.js")]),s._v(" 的体积极大地增加，请求时间很长，导致渲染阻塞。")])]),s._v(" "),t("li",[t("p",[t("strong",{staticStyle:{color:"red"}},[s._v("请求数量多")]),s._v(" ：而如果将所有的图片和字体全部输出对应文件，则大量的小文件（几 kb）又都会发起请求，请求数量增多，会造成一定的性能影响。")])])])]),t("h2",{attrs:{id:"_3-优化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-优化"}},[s._v("#")]),s._v(" 3. 优化")]),s._v(" "),t("h3",{attrs:{id:"_3-1-方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-方案"}},[s._v("#")]),s._v(" 3.1 方案")]),s._v(" "),t("p",[s._v("综合考虑 "),t("code",[s._v("base64")]),s._v(" 的优缺点，对 "),t("code",[s._v("webpack")]),s._v(" 配置进行优化：")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("ol",[t("li",[t("p",[s._v("对于体积 "),t("strong",{staticStyle:{color:"green"}},[s._v("较大")]),s._v(" 的图片（字体），"),t("strong",{staticStyle:{color:"green"}},[s._v("输出对应文件")]),s._v(" ，减少最终 "),t("code",[s._v("bundle")]),s._v(" 的体积，防止渲染阻塞。")])]),s._v(" "),t("li",[t("p",[s._v("对于体积 "),t("strong",{staticStyle:{color:"green"}},[s._v("较小")]),s._v(" 的图片（字体），"),t("strong",{staticStyle:{color:"green"}},[s._v("转化为 "),t("code",[s._v("base64")])]),s._v(" ，直接从内存缓存获取，减少请求数量。")])])])]),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* webpack.common.js */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" path "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"path"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmodule"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("module")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("rules")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("test")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token regex"}},[t("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("\\.(png|jpg|jpeg|gif|svg|webp)$")]),t("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("use")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("loader")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"url-loader"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("options")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n              "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 设置阈值")]),s._v("\n              "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("limit")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n              "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 输出文件命名")]),s._v("\n              "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[name].[ext]"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n              "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 关闭 es6 模块化")]),s._v("\n              "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("esModule")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n              "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 指定输出路径")]),s._v("\n              "),t("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("outputPath")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("url"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" resourcePath"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" context")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" pathArr "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" resourcePath"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("split")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token regex"}},[t("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("\\/|\\\\")]),t("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" widgetIndex "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pathArr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("findIndex")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("p")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" p "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"widgets"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("widgetIndex "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token template-string"}},[t("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token interpolation"}},[t("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v("pathArr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("widgetIndex "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("/public/img/")]),t("span",{pre:!0,attrs:{class:"token interpolation"}},[t("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v("url"),t("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),t("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n              "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("include")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" path"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolve")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__dirname"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"../"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"src/widgets"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("test")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token regex"}},[t("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("\\.(woff2?|eot|ttf|TTF|otf)(\\?.*)?$")]),t("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("use")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("loader")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"url-loader"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("options")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n              "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("limit")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n              "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[name].[ext]"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n              "),t("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("outputPath")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("url"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" resourcePath"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" context")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" pathArr "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" resourcePath"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("split")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token regex"}},[t("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("\\/|\\\\")]),t("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" widgetIndex "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pathArr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("findIndex")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("p")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" p "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"widgets"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("widgetIndex "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token template-string"}},[t("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token interpolation"}},[t("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v("pathArr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("widgetIndex "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("/public/css/font/")]),t("span",{pre:!0,attrs:{class:"token interpolation"}},[t("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v("url"),t("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),t("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n              "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("include")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" path"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolve")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__dirname"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"../"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"src/widgets"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br")])]),t("p",[s._v("上述代码中，对处理图片和字体的 "),t("code",[s._v("url-loader")]),s._v(" 进行了具体的配置：")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("ul",[t("li",[t("p",[t("strong",[s._v("设置阈值")]),s._v("：由于图片大部分都小于 "),t("code",[s._v("12kb")]),s._v("，且 12kb 以下的图片在转为 "),t("code",[s._v("base64")]),s._v(" 后体积也不会很大，对 "),t("code",[s._v("index.js")]),s._v(" 的体积没有太大影响，因此考虑将阈值( "),t("code",[s._v("limit")]),s._v(" )设为 12kb。")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("文件命名")]),s._v("：对输出的文件进行命名，名称和扩展名与源文件保持一致。")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("关闭 ES6 模块化")]),s._v("：关闭 "),t("code",[s._v("ES6")]),s._v(" 的模块化，采用 "),t("code",[s._v("Commonjs")]),s._v(" 解析，防止解析出错。")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("指定输出路径")]),s._v("：将图片和字体按类别输出到对应的文件夹（ "),t("code",[s._v("/img")]),s._v(" 和 "),t("code",[s._v("/css/font")]),s._v(" ）下。")])])])]),t("h3",{attrs:{id:"_3-2-效果"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-效果"}},[s._v("#")]),s._v(" 3.2 效果")]),s._v(" "),t("p",[s._v("重新打包部署后，性能分析如下：")]),s._v(" "),t("img",{staticClass:"zoomable",attrs:{src:s.$withBase("/images/screenshot/notes/3/1/7.png"),alt:"foo"}}),s._v(" "),t("p",[s._v("从上图中可以看出，优化后：")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("ul",[t("li",[s._v("『白屏时间』减少至 "),t("code",[s._v("1.4 s")]),s._v(" 。")]),s._v(" "),t("li",[t("code",[s._v("index.js")]),s._v(" 的体积减小至 "),t("code",[s._v("509 kb")]),s._v("，占用时长减少至 "),t("code",[s._v("222.29 ms")]),s._v("。")])])]),t("p",[s._v("图片字体获取方式如下：")]),s._v(" "),t("img",{staticClass:"zoomable",attrs:{src:s.$withBase("/images/screenshot/notes/3/1/8.png"),alt:"foo"}}),s._v(" "),t("img",{staticClass:"zoomable",attrs:{src:s.$withBase("/images/screenshot/notes/3/1/9.png"),alt:"foo"}}),s._v(" "),t("p",[s._v("从上图可以看出，优化后，项目中：")]),s._v(" "),t("ul",[t("li",[s._v("12kb 以下的图片和字体 "),t("strong",[s._v("（绿框内的）")]),s._v(" 转为 "),t("code",[s._v("base64")]),s._v(" ，直接从『内存缓存』中获取。")]),s._v(" "),t("li",[s._v("12kb 以上的图片和字体 "),t("strong",[s._v("（红框内的）")]),s._v(" 则需要通过『请求』获取。")])]),s._v(" "),t("h2",{attrs:{id:"_4-对比"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-对比"}},[s._v("#")]),s._v(" 4. 对比")]),s._v(" "),t("p",[s._v("比较优化前后的一些性能指标：")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("比较项")]),s._v(" "),t("th",[s._v("index.js 体积")]),s._v(" "),t("th",[s._v("index.js 请求时间")]),s._v(" "),t("th",[s._v("index.js 加载时间")]),s._v(" "),t("th",[s._v("白屏时间")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("优化前")]),s._v(" "),t("td",[t("strong",[t("code",[s._v("32.8 MB")])])]),s._v(" "),t("td",[s._v("2.5 s")]),s._v(" "),t("td",[s._v("1.40 s")]),s._v(" "),t("td",[t("strong",[t("code",[s._v("5.6 s")])])])]),s._v(" "),t("tr",[t("td",[s._v("优化后")]),s._v(" "),t("td",[t("strong",[t("code",[s._v("509 KB")])])]),s._v(" "),t("td",[s._v("88 ms")]),s._v(" "),t("td",[s._v("134 ms")]),s._v(" "),t("td",[t("strong",[t("code",[s._v("1.4 s")])])])])])]),s._v(" "),t("p",[s._v("对比可以发现，"),t("strong",{staticStyle:{color:"green"}},[s._v("优化前后，首页加载性能大幅提升，就白屏时间而言，性能提升了 "),t("code",[s._v("300%")]),s._v(" ！")])]),s._v(" "),t("p",[s._v("优化后的白屏时间完全在可接受范围内，"),t("strong",{staticStyle:{color:"green"}},[s._v("用户使用体验明显改善")]),s._v(" 。")]),s._v(" "),t("h2",{attrs:{id:"_5-总结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-总结"}},[s._v("#")]),s._v(" 5. 总结")]),s._v(" "),t("p",[s._v("从大方向来说，优化分为『开发环境优化』和『生产环境优化』，前者是为了方便开发人员更好地开发和调试，后者是为了提升产品质量和用户体验，对于开发人员来说，应该将优化重心放在后者。")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("p",[s._v("性能优化涉及方方面面，在采用 "),t("code",[s._v("webpack")]),s._v(" 作为前端构建工具时，需要尽可能了解常见 "),t("code",[s._v("loader")]),s._v(" 和 "),t("code",[s._v("plugin")]),s._v(" 的原理和用法，针对性地对性能问题做出优化，包括但不限于以下方面：")]),s._v(" "),t("ul",[t("li",[t("strong",[t("code",[s._v("js")]),s._v(" 的语法检查、兼容性处理、压缩")])]),s._v(" "),t("li",[t("strong",[t("code",[s._v("css")]),s._v(" 的转化、兼容性处理、提取、压缩")])]),s._v(" "),t("li",[t("strong",[t("code",[s._v("html")]),s._v(" 的压缩")])]),s._v(" "),t("li",[t("strong",[s._v("图片的模块化解析、base64 转化")])])])]),t("p",[s._v("本案例中，『首页白屏时间过长』的主要原因是因为图片和字体全都被转为 "),t("code",[s._v("base64")]),s._v(" 写入到输出的 "),t("code",[s._v("index.js")]),s._v(" 中，导致 "),t("code",[s._v("index.js")]),s._v(" 体积非常大，请求和加载时间过长，页面渲染阻塞，因此针对性地对图片和字体的打包进行优化处理，最终大大缩减了首页白屏时间，达到了提升用户体验的目标。")])])}),[],!1,null,null,null);t.default=e.exports}}]);